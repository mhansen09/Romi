<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

  <meta property="og:title" content="Treating Functions as Data" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://docs.wpilib.org/en/stable/docs/software/basic-programming/functions-as-data.html" />
  <meta property="og:site_name" content="FIRST Robotics Competition Documentation" />
  <meta property="og:description" content="Regardless of programming language, one of the first things anyone learns to do when programming a computer is to write a function (also known as a “method” or a “subroutine”). Functions are a fund..." />
  <meta property="og:image" content="https://raw.githubusercontent.com/wpilibsuite/branding/main/png/wpilib-128.png" />
  <meta property="og:image:alt" content="FIRST Robotics Competition Documentation" />
  <meta property="og:ignore_canonical" content="true" />
<meta name="theme-color" content="#003974" />
<meta name="google-site-verification" content="xcmdxM0KzMYiAOeJzyF_l2Tn3AHGzPICs9_vX6q2nwM" />
<link rel="alternate" hreflang="en" href="https://docs.wpilib.org/en/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.wpilib.org/en/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="es" href="https://docs.wpilib.org/es/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="fr" href="https://docs.wpilib.org/fr/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="he" href="https://docs.wpilib.org/he/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="pt" href="https://docs.wpilib.org/pt/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="tr" href="https://docs.wpilib.org/tr/stable/docs/software/basic-programming/functions-as-data.html" />
<link rel="alternate" hreflang="zh-CN" href="https://docs.wpilib.org/zh_CN/stable/docs/software/basic-programming/functions-as-data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Treating Functions as Data &mdash; FIRST Robotics Competition  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/pid-tune.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/frc-rtd.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/sphinx_rtd_theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/FIRSTicon_RGB_withTM.ico"/>
    <link rel="canonical" href="https://docs.wpilib.org/en/stable/docs/software/basic-programming/functions-as-data.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script async="async" src="../../../_static/js/present.js"></script>
        <script src="../../../_static/js/hoverxref.js"></script>
        <script src="../../../_static/js/tooltipster.bundle.min.js"></script>
        <script src="../../../_static/js/micromodal.min.js"></script>
        <script src="../../../_static/js/versionwarning.js"></script>
        <script src="../../../_static/pid-tune.js"></script>
        <script src="../../../_static/js/api-docs-redirect.js"></script>
        <script src="../../../_static/js/fix-rtd-menu-ios.js"></script>
        <script src="../../../_static/js/external-links-new-tab.js"></script>
        <script src="../../../_static/js/version-2014.js"></script>
        <script src="../../../_static/tabs.js"></script>
        <script src="../../../_static/design-tabs.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Support Resources" href="../support/support-resources.html" />
    <link rel="prev" title="Reading Stacktraces" href="reading-stacktraces.html" /> 
</head>

<body class="wy-body-for-nav"> 


<div class="header-bar">
        <!-- Color Strip -->
        <div class="color-strip">
            <div class="fred"></div>
            <div class="forange"></div>
            <div class="fblue"></div>
        </div>
        <div class="link-bar-container">
            <div id="link-bar" class="collapse">
                <ul>          
                  <li id="manual-link"><a href="https://www.firstinspires.org/resource-library/frc/competition-manual-qa-system">FRC Game Manual</a></li>
                  <li id="qa-link"><a href="https://frc-qa.firstinspires.org/">FRC Game Q&A</a></li>
                  <script id="headerscript">
                    if( new Date().getMonth() == 3 && new Date().getDate() == 1) {
                      document.getElementById("headerscript").insertAdjacentHTML("afterend", '<li id="water-link"><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">Water Game</a></li>');
                    }
                  </script>
                </ul>
            </div>
        </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  <a href="../../../index.html" style="display: block; margin-bottom: 0;">
      FIRST Robotics Competition
    <picture>
      <source
        sizes="300px"
        srcset="../../../_static/wpilibDocsLogo_300.webp 300w, ../../../_static/wpilibDocsLogo_500.webp 500w, ../../../_static/wpilibDocsLogo_700.webp 700w, ../../../_static/wpilibDocsLogo_1050.webp 1050w"
        type="image/webp"
      />
      <img
        src="../../../_static/wpilibDocsLogo.png"
        sizes="300px"
        srcset="../../../_static/wpilibDocsLogo_300.png 300w, ../../../_static/wpilibDocsLogo_500.png 500w, ../../../_static/wpilibDocsLogo_700.png 700w, ../../../_static/wpilibDocsLogo_1050.png 1050w"
        height="468"
        width="1050"
        alt="Logo"
        decoding="async"
        class="logo"
        style="height: auto; width: 100%; border-radius: 0%;"
      />
    </picture>
  </a>
      <div class="version">
        latest
      </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Zero to Robot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-1/index.html">Step 1: Building your Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-2/index.html">Step 2: Installing Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-3/index.html">Step 3: Preparing Your Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-4/index.html">Step 4: Programming your Robot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Control System Overviews</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../controls-overviews/control-system-hardware.html">Hardware Component Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../controls-overviews/control-system-software.html">Software Component Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Basics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../what-is-wpilib.html">What is WPILib?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../yearly-overview/index.html">2023 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vscode-overview/index.html">VS Code Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dashboards/index.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../telemetry/index.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labview/index.html">FRC LabVIEW Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware-apis/index.html">Hardware APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../can-devices/index.html">CAN Devices</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Basic Programming</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="git-getting-started.html">Git Version Control Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp-units.html">The C++ Units Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="joystick.html">Joysticks</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot-preferences.html">Setting Robot Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="using-test-mode.html">Using Test Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="reading-stacktraces.html">Reading Stacktraces</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Treating Functions as Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../support/support-resources.html">Support Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frc-glossary.html">FRC Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/java/index.html">WPILib Java API Docs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/cpp/index.html">WPILib C++ API Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driverstation/index.html">Driver Station</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/robotbuilder/index.html">RobotBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/robot-simulation/index.html">Robot Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/outlineviewer/index.html">OutlineViewer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vision-processing/index.html">Vision Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commandbased/index.html">Command-Based Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kinematics-and-odometry/index.html">Kinematics and Odometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networktables/index.html">NetworkTables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pathplanning/index.html">Path Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roborio-info/index.html">roboRIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-gradlerio/index.html">Advanced GradleRIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-controls/index.html">Advanced Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../convenience-features/index.html">Convenience Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples and Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples-tutorials/wpilib-examples.html">WPILib Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples-tutorials/third-party-examples.html">Third Party Example Projects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/hardware-basics/index.html">Hardware - Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/hardware-tutorials/index.html">Hardware Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/sensors/index.html">Sensors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Romi Robot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../romi-robot/index.html">Getting Started with Romi</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Robot Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../networking/networking-introduction/index.html">Networking Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/networking-utilities/index.html">Networking Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/frc-docs/index.html">Contributing to frc-docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/wpilib/index.html">Developing with allwpilib</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Issues</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/wpilibsuite/frc-docs/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">FIRST Robotics Competition</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Basic Programming</a></li>
      <li class="breadcrumb-item active">Treating Functions as Data</li>
<li class="wy-breadcrumbs-aside" style="padding-inline-start: 6px;">
    <a href="?present" class="btn" style="background-color: #2980b9; color: white; padding: 5px">
        Present
        <span class="fa fa-expand"></span>
    </a>
</li>

      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/wpilibsuite/frc-docs/blob/main/source/docs/software/basic-programming/functions-as-data.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="treating-functions-as-data">
<h1>Treating Functions as Data<a class="headerlink" href="#treating-functions-as-data" title="Permalink to this heading"></a></h1>
<p>Regardless of programming language, one of the first things anyone learns to do when programming a computer is to write a function (also known as a “method” or a “subroutine”).  Functions are a fundamental part of organized code - writing functions lets us avoid duplicating the same piece of code over and over again.  Instead of writing duplicated sections of code, we call a single function that contains the code we want to execute from multiple places (provided we named the function well, the function name is also easier to read than the code itself!).  If the section of code needs some additional information about its surrounding context to run, we pass those to the function as “parameters”, and if it needs to yield something back to the rest of the code once it finishes, we call that a “return value” (together, the parameters and return value are called the function’s “signature”);</p>
<p>Sometimes, we need to pass functions from one part of the code to another part of the code.  This might seem like a strange concept, if we’re used to thinking of functions as part of a class definition rather than objects in their own right.  But at a basic level, functions are just data - in the same way we can store an <code class="docutils literal notranslate"><span class="pre">integer</span></code> or a <code class="docutils literal notranslate"><span class="pre">double</span></code> as a variable and pass it around our program, we can do the same thing with a function.  A variable whose value is a function is called a “functional interface” in Java, and a “function pointer” or “functor” in C++.</p>
<section id="why-would-we-want-to-treat-functions-as-data">
<h2>Why Would We Want to Treat Functions as Data?<a class="headerlink" href="#why-would-we-want-to-treat-functions-as-data" title="Permalink to this heading"></a></h2>
<p>Typically, code that calls a function is coupled to (depends on) the definition of the function. While this occurs all the time, it becomes problematic when the code <em>calling</em> the function (for example, WPILib) is developed independently and without direct knowledge of the code that <em>defines</em> the function (for example, code from an FRC team). Sometimes we solve this challenge through the use of class interfaces, which define collections of data and functions that are meant to be used together.  However, often we really only have a dependency on a <em>single function</em>, rather than on an <em>entire class</em>.</p>
<p>For example, WPILib offers several ways for users to execute certain code whenever a joystick button is pressed - one of the easiest and cleanest ways to do this is to allow the user to <em>pass a function</em> to one of the WPILib joystick methods.  This way, the user only has to write the code that deals with the interesting and team-specific things (e.g., “move my robot arm”) and not the boring, error-prone, and universal thing (“properly read button inputs from a standard joystick”).</p>
<p>For another example, the <a class="reference internal" href="../commandbased/what-is-command-based.html#what-is-command-based-programming"><span class="std std-ref">Command-based framework</span></a> is built on <code class="docutils literal notranslate"><span class="pre">Command</span></code> objects that refer to methods defined on various <code class="docutils literal notranslate"><span class="pre">Subsystem</span></code> classes.  Many of the included <code class="docutils literal notranslate"><span class="pre">Command</span></code> types (such as <code class="docutils literal notranslate"><span class="pre">InstantCommand</span></code> and <code class="docutils literal notranslate"><span class="pre">RunCommand</span></code>) work with <em>any</em> function - not just functions associated with a single <code class="docutils literal notranslate"><span class="pre">Subsystem</span></code>.  To support building commands generically, we need to support passing functions from a <code class="docutils literal notranslate"><span class="pre">Subsystem</span></code> (which interacts with the hardware) to a <code class="docutils literal notranslate"><span class="pre">Command</span></code> (which interacts with the scheduler).</p>
<p>In these cases, we want to be able to pass a single function as a piece of data, as if it were a variable - it doesn’t make sense to ask the user to provide an entire class, when we really just want them to give us a single appropriately-shaped function.</p>
<p>It’s important that <em>passing</em> a function is not the same as <em>calling</em> a function.  When we call a function, we execute the code inside of it and either receive a return value, cause some side-effects elsewhere in the code, or both.  When we <em>pass</em> a function, nothing in particular happens <em>immediately.</em>  Instead, by passing the function we are allowing some <em>other</em> code to call the function <em>in the future.</em>  Seeing the name of a function in code does not always mean that the code in the function is being run!</p>
<p>Inside of code that passes a function, we will see some syntax that either refers to the name of an existing function in a special way, or else defines a new function to be passed inside of the call expression.  The specific syntax needed (and the rules around it) depends on which programming language we are using.</p>
</section>
<section id="treating-functions-as-data-in-java">
<h2>Treating Functions as Data in Java<a class="headerlink" href="#treating-functions-as-data-in-java" title="Permalink to this heading"></a></h2>
<p>Java represents functions-as-data as instances of <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html">functional interfaces</a>.  A “functional interface” is a special kind of class that has only a single method - since Java was originally designed strictly for object-oriented programming, it has no way of representing a single function detached from a class.  Instead, it defines a particular group of classes that <em>only</em> represent single functions.  Each type of function signature has its own functional interface, which is an interface with a single function definition of that signature.</p>
<p>This might sound complicated, but in the context of WPILib we don’t really need to worry much about using the functional interfaces themselves - the code that does that is internal to WPILib.  Instead, all we need to know is how to pass a function that we’ve written to a method that takes a functional interface as a parameter.  For a simple example, consider the signature of <code class="docutils literal notranslate"><span class="pre">Commands.runOnce</span></code> (which creates an <code class="docutils literal notranslate"><span class="pre">InstantCommand</span></code> that, when scheduled, runs the given function once and then terminates):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">requirements</span></code> parameter is explained in the <a class="reference internal" href="../commandbased/commands.html#getrequirements"><span class="std std-ref">Command-based documentation</span></a>, and will not be discussed here.</p>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">CommandBase</span><span class="w"> </span><span class="nf">runOnce</span><span class="p">(</span><span class="n">Runnable</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"> </span><span class="n">Subsystem</span><span class="p">...</span><span class="w"> </span><span class="n">requirements</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">runOnce</span></code> expects us to give it a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> parameter (named <code class="docutils literal notranslate"><span class="pre">action</span></code>).  A <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> is the Java term for a function that takes no parameters and returns no value.  When we call <code class="docutils literal notranslate"><span class="pre">runOnce</span></code>, we need to give it a function with no parameters and no return value.  There are two ways to do this: we can refer to some existing function using a “method reference”, or we can define the function we want inline using a “lambda expression”.</p>
<section id="method-references">
<h3>Method References<a class="headerlink" href="#method-references" title="Permalink to this heading"></a></h3>
<p>A method reference lets us pass an already-existing function as our <code class="docutils literal notranslate"><span class="pre">Runnable</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an InstantCommand that runs the `resetEncoders` method of the `drivetrain` object</span><span class="w"></span>
<span class="n">Command</span><span class="w"> </span><span class="n">disableCommand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runOnce</span><span class="p">(</span><span class="n">drivetrain</span><span class="p">::</span><span class="n">resetEncoders</span><span class="p">,</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The expression <code class="docutils literal notranslate"><span class="pre">drivetrain::resetEncoders</span></code> is a reference to the <code class="docutils literal notranslate"><span class="pre">resetEncoders</span></code> method of the <code class="docutils literal notranslate"><span class="pre">drivetrain</span></code> object.  It is not a method <em>call</em> - this line of code does not <em>itself</em> reset the encoders of the drivetrain.  Instead, it returns a <code class="docutils literal notranslate"><span class="pre">Command</span></code> that will do so <em>when it is scheduled.</em></p>
<p>Remember that in order for this to work, <code class="docutils literal notranslate"><span class="pre">resetEncoders</span></code> must be a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> - that is, it must take no parameters and return no value.  So, its signature must look like this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// void because it returns no parameters, and has an empty parameter list</span><span class="w"></span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resetEncoders</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
<p>If the function signature does not match this, Java will not be able to interpret the method reference as a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> and the code will not compile.  Note that all we need to do is make sure that the signature matches the signature of the single method in the <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> functional interface - we don’t need to <em>explicitly</em> name it as a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code>.</p>
</section>
<section id="lambda-expressions-in-java">
<h3>Lambda Expressions in Java<a class="headerlink" href="#lambda-expressions-in-java" title="Permalink to this heading"></a></h3>
<p>If we do not already have a named function that does what we want, we can define a function “inline” - that means, right inside of the call to <code class="docutils literal notranslate"><span class="pre">runOnce</span></code>!  We do this by writing our function with a special syntax that uses an “arrow” symbol to link the argument list to the function body:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an InstantCommand that runs the drive forward at half speed</span><span class="w"></span>
<span class="n">Command</span><span class="w"> </span><span class="n">driveHalfSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runOnce</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">.</span><span class="na">arcadeDrive</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Java calls <code class="docutils literal notranslate"><span class="pre">()</span> <span class="pre">-&gt;</span> <span class="pre">{</span> <span class="pre">drivetrain.arcadeDrive(0.5,</span> <span class="pre">0.0);</span> <span class="pre">}</span></code> a “lambda expression”; it may be less-confusingly called an “arrow function”, “inline function”, or “anonymous function” (because it has no name).  While this may look a bit funky, it is just another way of writing a function - the parentheses before the arrow are the function’s argument list, and the code contained in the brackets is the function body.  The “lambda expression” here represents a function that calls <code class="docutils literal notranslate"><span class="pre">drivetrain.arcadeDrive</span></code> with a specific set of parameters - note again that this does not <em>call</em> the function, but merely defines it and passes it to the <code class="docutils literal notranslate"><span class="pre">Command</span></code> to be run later when the <code class="docutils literal notranslate"><span class="pre">Command</span></code> is scheduled.</p>
<p>As with method references, we do not need to <em>explicitly</em> name the lambda expression as a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> - Java can infer that our lambda expression is a <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> so long as its signature matches that of the single method in the <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> interface.  Accordingly, our lambda takes no arguments and has no return statement - if it did not match the <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> contract, our code would fail to compile.</p>
<section id="capturing-state-in-java-lambda-expressions">
<h4>Capturing State in Java Lambda Expressions<a class="headerlink" href="#capturing-state-in-java-lambda-expressions" title="Permalink to this heading"></a></h4>
<p>In the above example, our function body references an object that lives outside of the function itself (namely, the <code class="docutils literal notranslate"><span class="pre">drivetrain</span></code> object).  This is called a “capture” of a variable from the surrounding code (which is sometimes called the “outer scope” or “enclosing scope”).  Usually the captured variables are either local variables from the enclosing method body in which the lambda expression is defined, or else fields of an enclosing class definition in which that method is defined.</p>
<p>In Java capturing state is a fairly safe thing to do in general, with one major caveat: we can only capture state that is “effectively final”.  That means it is only legal to capture a variable from the enclosing scope if that variable is never reassigned after initialization.  Note that this does not mean that the captured state cannot change: Remember that Java objects are references, so the object that the reference <em>points to</em> may change after capture - but the reference itself cannot be made to point to another object.</p>
<p>This means we can only capture primitive types (like <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, and <code class="docutils literal notranslate"><span class="pre">boolean</span></code>) if they’re constants.  If we want to capture a state variable that can change, it <em>must be wrapped in a mutable object</em>.</p>
</section>
</section>
<section id="syntactic-sugar-for-java-lambda-expressions">
<h3>Syntactic Sugar for Java Lambda Expressions<a class="headerlink" href="#syntactic-sugar-for-java-lambda-expressions" title="Permalink to this heading"></a></h3>
<p>The full lambda expression syntax can be needlessly verbose in some cases.  To help with this, Java lets us take some shortcuts (called “syntactic sugar”) in cases where some of the notation is redundant.</p>
<section id="omitting-function-body-brackets-for-one-line-lambdas">
<h4>Omitting Function Body Brackets for One-Line Lambdas<a class="headerlink" href="#omitting-function-body-brackets-for-one-line-lambdas" title="Permalink to this heading"></a></h4>
<p>If the function body of our lambda expression is only one line, Java lets us omit the brackets around the function body.  When omitting function brackets, we also omit trailing semicolons And the <cite>return</cite> keyword.</p>
<p>So, our <code class="docutils literal notranslate"><span class="pre">Runnable</span></code> lambda above could instead be written:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an InstantCommand that runs the drive forward at half speed</span><span class="w"></span>
<span class="n">Command</span><span class="w"> </span><span class="n">driveHalfSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runOnce</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">.</span><span class="na">arcadeDrive</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">),</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="omitting-parentheses-around-single-lambda-parameters">
<h4>Omitting Parentheses around Single Lambda Parameters<a class="headerlink" href="#omitting-parentheses-around-single-lambda-parameters" title="Permalink to this heading"></a></h4>
<p>If the lambda expression is for a functional interface that takes only a single argument, we can omit the parenthesis around the parameter list:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// We can write this lambda with no parenthesis around its single argument</span><span class="w"></span>
<span class="n">IntConsumer</span><span class="w"> </span><span class="n">exampleLambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="treating-functions-as-data-in-c">
<h2>Treating Functions as Data in C++<a class="headerlink" href="#treating-functions-as-data-in-c" title="Permalink to this heading"></a></h2>
<p>C++ has a number of ways to treat functions as data.  For the sake of this article, we’ll only talk about the parts that are relevant to using WPILibC.</p>
<p>In WPILibC, function types are represented with the <code class="docutils literal notranslate"><span class="pre">std::function</span></code> class (<a class="reference external" href="https://en.cppreference.com/w/cpp/utility/functional/function">https://en.cppreference.com/w/cpp/utility/functional/function</a>).  This standard library class is templated on the function’s signature - that means we have to provide it a <a class="reference external" href="https://stackoverflow.com/questions/17446220/c-function-types">function type</a> as a template parameter to specify the signature of the function (compare this to <a class="reference internal" href="#treating-functions-as-data-in-java"><span class="std std-ref">Java</span></a> above, where we have a separate interface type for each kind of signature).</p>
<p>This sounds a lot more complicated than it is to use in practice.  Let’s look at the call signature of <code class="docutils literal notranslate"><span class="pre">cmd::RunOnce</span></code> (which creates an <code class="docutils literal notranslate"><span class="pre">InstantCommand</span></code> that, when scheduled, runs the given function once and then terminates):</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">requirements</span></code> parameter is explained in the <a class="reference internal" href="../commandbased/commands.html#getrequirements"><span class="std std-ref">Command-based documentation</span></a>, and will not be discussed here.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">CommandPtr</span><span class="w"> </span><span class="nf">RunOnce</span><span class="p">(</span><span class="w"></span>
<span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="n">action</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">initializer_list</span><span class="o">&lt;</span><span class="n">Subsystem</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">requirements</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">runOnce</span></code> expects us to give it a <code class="docutils literal notranslate"><span class="pre">std::function&lt;void()&gt;</span></code> parameter (named <code class="docutils literal notranslate"><span class="pre">action</span></code>).  A <code class="docutils literal notranslate"><span class="pre">std::function&lt;void()&gt;</span></code> is the C++ type for a <code class="docutils literal notranslate"><span class="pre">std::function</span></code> that takes no parameters and returns no value (the template parameter, <code class="docutils literal notranslate"><span class="pre">void()</span></code>, is a function type with no parameters and no return value).  When we call <code class="docutils literal notranslate"><span class="pre">runOnce</span></code>, we need to give it a function with no parameters and no return value.  C++ lacks a clean way to refer to existing class methods in a way that can automatically be converted to a <code class="docutils literal notranslate"><span class="pre">std::function</span></code>, so the typical way to do this is to define a new function inline with a “lambda expression”.</p>
<section id="lambda-expressions-in-c">
<h3>Lambda Expressions in C++<a class="headerlink" href="#lambda-expressions-in-c" title="Permalink to this heading"></a></h3>
<p>To pass a function to <code class="docutils literal notranslate"><span class="pre">runOnce</span></code>, we need to write a short inline function expression using a special syntax that resembles ordinary C++ function declarations, but varies in a few important ways:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create an InstantCommand that runs the drive forward at half speed</span>
<span class="n">CommandPtr</span><span class="w"> </span><span class="n">driveHalfSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmd</span><span class="o">::</span><span class="n">RunOnce</span><span class="p">([</span><span class="k">this</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">drivetrain</span><span class="p">.</span><span class="n">ArcadeDrive</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">);</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">drivetrain</span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>C++ calls <code class="docutils literal notranslate"><span class="pre">[captures]</span> <span class="pre">(params)</span> <span class="pre">{</span> <span class="pre">body;</span> <span class="pre">}</span></code> a “lambda expression”.  It has three parts: a <em>capture list</em> (square brackets), an optional <em>parameter list</em> (parentheses), and a <em>function body</em> (curly brackets).  It may look a little strange, but the only real difference between a lambda expression and an ordinary function (apart from the lack of a function name) is the addition of the capture list.</p>
<p>Since <code class="docutils literal notranslate"><span class="pre">RunOnce</span></code> wants a function with no parameters and no return value, our lambda expression has no parameter list and no return statement.  The “lambda expression” here represents a function that calls <code class="docutils literal notranslate"><span class="pre">drivetrain.ArcadeDrive</span></code> with a specific set of parameters - note again that the above code does not <em>call</em> the function, but merely defines it and passes it to the <code class="docutils literal notranslate"><span class="pre">Command</span></code> to be run later when the <code class="docutils literal notranslate"><span class="pre">Command</span></code> is scheduled.</p>
<section id="capturing-state-in-c-lambda-expressions">
<h4>Capturing State in C++ Lambda Expressions<a class="headerlink" href="#capturing-state-in-c-lambda-expressions" title="Permalink to this heading"></a></h4>
<p>In the above example, our function body references an object that lives outside of the function itself (namely, the <code class="docutils literal notranslate"><span class="pre">drivetrain</span></code> object).  This is called a “capture” of a variable from the surrounding code (which is sometimes called the “outer scope” or “enclosing scope”).  Usually the captured variables are either local variables from the enclosing method body in which the lambda expression is defined, or else fields of an enclosing class definition in which that method is defined.</p>
<p>C++ has somewhat more-powerful semantics than Java.  One cost of this is that we generally need to give the C++ compiler some help to figure out <em>how exactly</em> we want it to capture state from the enclosing scope.  This is the purpose of the <em>capture list</em>.  For the purposes of using the WPILibC Command-based framework, it is usually sufficient to use a capture list of <code class="docutils literal notranslate"><span class="pre">[this]</span></code>, which gives access to members of the enclosing class by capturing the enclosing class’s <code class="docutils literal notranslate"><span class="pre">this</span></code> pointer by value.</p>
<p>Method locals cannot be captured with the <code class="docutils literal notranslate"><span class="pre">this</span></code> pointer, and must be captured explicitly either by reference or by value by including them in the capture list (or by implicitly by instead specifying a default capture semantics).  It is typically safer to capture locals by-value, since a lambda can outlive the lifespan of an object it captures by reference.  For more details, consult the <a class="reference external" href="https://en.cppreference.com/w/cpp/language/lambda#Lambda_capture">C++ standard library documentation on capture semantics</a>.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reading-stacktraces.html" class="btn btn-neutral float-left" title="Reading Stacktraces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../support/support-resources.html" class="btn btn-neutral float-right" title="Support Resources" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, FIRST and other WPILib Contributors. This work is licensed under a Creative Commons Attribution 4.0 International License.
      <span class="commit">Revision <code>c3ff9f30</code>.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/2022/">2022</a></dd>
        
          <dd><a href="/en/2021/">2021</a></dd>
        
          <dd><a href="/en/2020/">2020</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//docs.wpilib.org/_/downloads/en/latest/pdf/">pdf</a></dd>
        
          <dd><a href="//docs.wpilib.org/_/downloads/en/latest/htmlzip/">html</a></dd>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/frc-docs/?fromdocs=frc-docs">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/frc-docs/?fromdocs=frc-docs">Builds</a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
  <script>
    if (typeof READTHEDOCS_DATA !== 'undefined') {
        if (!READTHEDOCS_DATA.features) {
          READTHEDOCS_DATA.features = {};
        }
        READTHEDOCS_DATA.features.docsearch_disabled = false;
      }
    </script>

</body>
</html>