<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18: http://docutils.sourceforge.net/" />

  <meta property="og:title" content="Combining Motion Profiling and PID in Command-Based" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://docs.wpilib.org/en/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
  <meta property="og:site_name" content="FIRST Robotics Competition Documentation" />
  <meta property="og:description" content="A common FRC Â® controls solution is to pair a trapezoidal motion profile for setpoint generation with a PID controller for setpoint tracking. To facilitate this, WPILib includes its own ProfiledPID..." />
  <meta property="og:image" content="https://raw.githubusercontent.com/wpilibsuite/branding/main/png/wpilib-128.png" />
  <meta property="og:image:alt" content="FIRST Robotics Competition Documentation" />
  <meta property="og:ignore_canonical" content="true" />
<meta name="theme-color" content="#003974" />
<meta name="google-site-verification" content="xcmdxM0KzMYiAOeJzyF_l2Tn3AHGzPICs9_vX6q2nwM" />
<link rel="alternate" hreflang="en" href="https://docs.wpilib.org/en/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="x-default" href="https://docs.wpilib.org/en/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="es" href="https://docs.wpilib.org/es/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="fr" href="https://docs.wpilib.org/fr/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="he" href="https://docs.wpilib.org/he/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="pt" href="https://docs.wpilib.org/pt/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="tr" href="https://docs.wpilib.org/tr/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
<link rel="alternate" hreflang="zh-CN" href="https://docs.wpilib.org/zh_CN/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Combining Motion Profiling and PID in Command-Based &mdash; FIRST Robotics Competition  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster.bundle.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-shadow.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-punk.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-noir.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-light.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/tooltipster-sideTip-borderless.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/micromodal.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/pid-tune.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/frc-rtd.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/sphinx_rtd_theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/FIRSTicon_RGB_withTM.ico"/>
    <link rel="canonical" href="https://docs.wpilib.org/en/stable/docs/software/commandbased/profilepid-subsystems-commands.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script async="async" src="../../../_static/js/present.js"></script>
        <script src="../../../_static/js/hoverxref.js"></script>
        <script src="../../../_static/js/tooltipster.bundle.min.js"></script>
        <script src="../../../_static/js/micromodal.min.js"></script>
        <script src="../../../_static/js/versionwarning.js"></script>
        <script src="../../../_static/pid-tune.js"></script>
        <script src="../../../_static/js/api-docs-redirect.js"></script>
        <script src="../../../_static/js/fix-rtd-menu-ios.js"></script>
        <script src="../../../_static/js/external-links-new-tab.js"></script>
        <script src="../../../_static/js/version-2014.js"></script>
        <script src="../../../_static/tabs.js"></script>
        <script src="../../../_static/design-tabs.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2020 Command-Based Rewrite: What Changed?" href="command-based-changes.html" />
    <link rel="prev" title="Motion Profiling through TrapezoidProfileSubsystems and TrapezoidProfileCommands" href="profile-subsystems-commands.html" /> 
</head>

<body class="wy-body-for-nav"> 


<div class="header-bar">
        <!-- Color Strip -->
        <div class="color-strip">
            <div class="fred"></div>
            <div class="forange"></div>
            <div class="fblue"></div>
        </div>
        <div class="link-bar-container">
            <div id="link-bar" class="collapse">
                <ul>          
                  <li id="manual-link"><a href="https://www.firstinspires.org/resource-library/frc/competition-manual-qa-system">FRC Game Manual</a></li>
                  <li id="qa-link"><a href="https://frc-qa.firstinspires.org/">FRC Game Q&A</a></li>
                  <script id="headerscript">
                    if( new Date().getMonth() == 3 && new Date().getDate() == 1) {
                      document.getElementById("headerscript").insertAdjacentHTML("afterend", '<li id="water-link"><a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">Water Game</a></li>');
                    }
                  </script>
                </ul>
            </div>
        </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
  <a href="../../../index.html" style="display: block; margin-bottom: 0;">
      FIRST Robotics Competition
    <picture>
      <source
        sizes="300px"
        srcset="../../../_static/wpilibDocsLogo_300.webp 300w, ../../../_static/wpilibDocsLogo_500.webp 500w, ../../../_static/wpilibDocsLogo_700.webp 700w, ../../../_static/wpilibDocsLogo_1050.webp 1050w"
        type="image/webp"
      />
      <img
        src="../../../_static/wpilibDocsLogo.png"
        sizes="300px"
        srcset="../../../_static/wpilibDocsLogo_300.png 300w, ../../../_static/wpilibDocsLogo_500.png 500w, ../../../_static/wpilibDocsLogo_700.png 700w, ../../../_static/wpilibDocsLogo_1050.png 1050w"
        height="468"
        width="1050"
        alt="Logo"
        decoding="async"
        class="logo"
        style="height: auto; width: 100%; border-radius: 0%;"
      />
    </picture>
  </a>
      <div class="version">
        latest
      </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Zero to Robot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-1/index.html">Step 1: Building your Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-2/index.html">Step 2: Installing Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-3/index.html">Step 3: Preparing Your Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zero-to-robot/step-4/index.html">Step 4: Programming your Robot</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Control System Overviews</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../controls-overviews/control-system-hardware.html">Hardware Component Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../controls-overviews/control-system-software.html">Software Component Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../what-is-wpilib.html">What is WPILib?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../yearly-overview/index.html">2023 Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vscode-overview/index.html">VS Code Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dashboards/index.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../telemetry/index.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labview/index.html">FRC LabVIEW Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware-apis/index.html">Hardware APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../can-devices/index.html">CAN Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic-programming/index.html">Basic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/support-resources.html">Support Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frc-glossary.html">FRC Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/java/index.html">WPILib Java API Docs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/cpp/index.html">WPILib C++ API Docs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driverstation/index.html">Driver Station</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/robotbuilder/index.html">RobotBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/robot-simulation/index.html">Robot Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wpilib-tools/outlineviewer/index.html">OutlineViewer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Programming</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../vision-processing/index.html">Vision Processing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Command-Based Programming</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what-is-command-based.html">What Is âCommand-Basedâ Programming?</a></li>
<li class="toctree-l2"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-compositions.html">Command Compositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="subsystems.html">Subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="binding-commands-to-triggers.html">Binding Commands to Triggers</a></li>
<li class="toctree-l2"><a class="reference internal" href="structuring-command-based-project.html">Structuring a Command-Based Robot Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="organizing-command-based.html">Organizing Command-Based Robot Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-scheduler.html">The Command Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp-command-discussion.html">A Technical Discussion on C++ Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="pid-subsystems-commands.html">PID Control through PIDSubsystems and PIDCommands</a></li>
<li class="toctree-l2"><a class="reference internal" href="profile-subsystems-commands.html">Motion Profiling through TrapezoidProfileSubsystems and TrapezoidProfileCommands</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Combining Motion Profiling and PID in Command-Based</a></li>
<li class="toctree-l2"><a class="reference internal" href="command-based-changes.html">2020 Command-Based Rewrite: What Changed?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kinematics-and-odometry/index.html">Kinematics and Odometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networktables/index.html">NetworkTables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pathplanning/index.html">Path Planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roborio-info/index.html">roboRIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-gradlerio/index.html">Advanced GradleRIO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced-controls/index.html">Advanced Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../convenience-features/index.html">Convenience Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples and Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples-tutorials/wpilib-examples.html">WPILib Example Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples-tutorials/third-party-examples.html">Third Party Example Projects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/hardware-basics/index.html">Hardware - Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/hardware-tutorials/index.html">Hardware Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/sensors/index.html">Sensors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Romi Robot</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../romi-robot/index.html">Getting Started with Romi</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Robot Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../networking/networking-introduction/index.html">Networking Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/networking-utilities/index.html">Networking Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/frc-docs/index.html">Contributing to frc-docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/wpilib/index.html">Developing with allwpilib</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Issues</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/wpilibsuite/frc-docs/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">FIRST Robotics Competition</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Command-Based Programming</a></li>
      <li class="breadcrumb-item active">Combining Motion Profiling and PID in Command-Based</li>
<li class="wy-breadcrumbs-aside" style="padding-inline-start: 6px;">
    <a href="?present" class="btn" style="background-color: #2980b9; color: white; padding: 5px">
        Present
        <span class="fa fa-expand"></span>
    </a>
</li>

      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/wpilibsuite/frc-docs/blob/main/source/docs/software/commandbased/profilepid-subsystems-commands.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="combining-motion-profiling-and-pid-in-command-based">
<h1>Combining Motion Profiling and PID in Command-Based<a class="headerlink" href="#combining-motion-profiling-and-pid-in-command-based" title="Permalink to this heading">ï</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a description of the WPILib PID control features used by these command-based wrappers, see <a class="reference internal" href="../advanced-controls/controllers/pidcontroller.html#pid-control-in-wpilib"><span class="std std-ref">PID Control in WPILib</span></a>.</p>
</div>
<p>A common FRCÂ® controls solution is to pair a trapezoidal motion profile for setpoint generation with a PID controller for setpoint tracking.  To facilitate this, WPILib includes its own <a class="reference internal" href="../advanced-controls/controllers/profiled-pidcontroller.html#combining-motion-profiling-and-pid-control-with-profiledpidcontroller"><span class="std std-ref">ProfiledPIDController</span></a> class.  To further aid teams in integrating this functionality into their robots, the command-based framework contains two convenience wrappers for the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDController</span></code> class: <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>, which integrates the controller into a subsystem, and <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code>, which integrates the controller into a command.</p>
<section id="profiledpidsubsystem">
<h2>ProfiledPIDSubsystem<a class="headerlink" href="#profiledpidsubsystem" title="Permalink to this heading">ï</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In C++, the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code> class is templated on the unit type used for distance measurements, which may be angular or linear.  The passed-in values <em>must</em> have units consistent with the distance units, or a compile-time error will be thrown.  For more information on C++ units, see <a class="reference internal" href="../basic-programming/cpp-units.html#the-c-units-library"><span class="std std-ref">The C++ Units Library</span></a>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code> class (<a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/wpilibj2/command/ProfiledPIDSubsystem.html">Java</a>, <a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/cpp/classfrc2_1_1_profiled_p_i_d_subsystem.html">C++</a>) allows users to conveniently create a subsystem with a built-in PIDController.  In order to use the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code> class, users must create a subclass of it.</p>
<section id="creating-a-profiledpidsubsystem">
<h3>Creating a ProfiledPIDSubsystem<a class="headerlink" href="#creating-a-profiledpidsubsystem" title="Permalink to this heading">ï</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">periodic</span></code> is overridden when inheriting from <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>, make sure to call <code class="docutils literal notranslate"><span class="pre">super.periodic()</span></code>! Otherwise, control functionality will not work properly.</p>
</div>
<p>When subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>, users must override two abstract methods to provide functionality that the class will use in its ordinary operation:</p>
<section id="getmeasurement">
<h4>getMeasurement()<a class="headerlink" href="#getmeasurement" title="Permalink to this heading">ï</a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-0-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-0-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-0-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">getMeasurement</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="n">Distance_t</span><span class="w"> </span><span class="nf">GetMeasurement</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div></div>
<p>The <code class="docutils literal notranslate"><span class="pre">getMeasurement</span></code> method returns the current measurement of the process variable.  The <code class="docutils literal notranslate"><span class="pre">PIDSubsystem</span></code> will automatically call this method from its <code class="docutils literal notranslate"><span class="pre">periodic()</span></code> block, and pass its value to the control loop.</p>
<p>Users should override this method to return whatever sensor reading they wish to use as their process variable measurement.</p>
</section>
<section id="useoutput">
<h4>useOutput()<a class="headerlink" href="#useoutput" title="Permalink to this heading">ï</a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-1-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-1-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-1-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">useOutput</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="n">setpoint</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">UseOutput</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="n">setpoint</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div></div>
<p>The <code class="docutils literal notranslate"><span class="pre">useOutput()</span></code> method consumes the output of the Profiled PID controller, and the current setpoint state (which is often useful for computing a feedforward).  The <code class="docutils literal notranslate"><span class="pre">PIDSubsystem</span></code> will automatically call this method from its <code class="docutils literal notranslate"><span class="pre">periodic()</span></code> block, and pass it the computed output of the control loop.</p>
<p>Users should override this method to pass the final computed control output to their subsystemâs motors.</p>
</section>
<section id="passing-in-the-controller">
<h4>Passing In the Controller<a class="headerlink" href="#passing-in-the-controller" title="Permalink to this heading">ï</a></h4>
<p>Users must also pass in a <code class="docutils literal notranslate"><span class="pre">ProfiledPIDController</span></code> to the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code> base class through the superclass constructor call of their subclass.  This serves to specify the PID gains, the motion profile constraints, and the period (if the user is using a non-standard main robot loop period).</p>
<p>Additional modifications (e.g. enabling continuous input) can be made to the controller in the constructor body by calling <code class="docutils literal notranslate"><span class="pre">getController()</span></code>.</p>
</section>
</section>
<section id="using-a-profiledpidsubsystem">
<h3>Using a ProfiledPIDSubsystem<a class="headerlink" href="#using-a-profiledpidsubsystem" title="Permalink to this heading">ï</a></h3>
<p>Once an instance of a <code class="docutils literal notranslate"><span class="pre">PIDSubsystem</span></code> subclass has been created, it can be used by commands through the following methods:</p>
<section id="setgoal">
<h4>setGoal()<a class="headerlink" href="#setgoal" title="Permalink to this heading">ï</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you wish to set the goal to a simple distance with an implicit target velocity of zero, an overload of <code class="docutils literal notranslate"><span class="pre">setGoal()</span></code> exists that takes a single distance value, rather than a full motion profile state.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">setGoal()</span></code> method can be used to set the setpoint of the <code class="docutils literal notranslate"><span class="pre">PIDSubsystem</span></code>.  The subsystem will automatically track to the setpoint using the defined output:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-2-SmF2YQ==" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// The subsystem will track to a goal of 5 meters and velocity of 3 meters per second.</span><span class="w"></span>
<span class="n">examplePIDSubsystem</span><span class="p">.</span><span class="na">setGoal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// The subsystem will track to a goal of 5 meters and velocity of 3 meters per second.</span>
<span class="n">examplePIDSubsystem</span><span class="p">.</span><span class="n">SetGoal</span><span class="p">({</span><span class="mi">5</span><span class="n">_m</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="n">_mps</span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
</div></div>
</section>
<section id="enable-and-disable">
<h4>enable() and disable()<a class="headerlink" href="#enable-and-disable" title="Permalink to this heading">ï</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">enable()</span></code> and <code class="docutils literal notranslate"><span class="pre">disable()</span></code> methods enable and disable the automatic control of the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>.  When the subsystem is enabled, it will automatically run the motion profile and the control loop and track to the goal.  When it is disabled, no control is performed.</p>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">enable()</span></code> method resets the internal <code class="docutils literal notranslate"><span class="pre">ProfiledPIDController</span></code>, and the <code class="docutils literal notranslate"><span class="pre">disable()</span></code> method calls the user-defined <a class="reference internal" href="#useoutput">useOutput()</a> method with both output and setpoint set to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</section>
</section>
<section id="full-profiledpidsubsystem-example">
<h3>Full ProfiledPIDSubsystem Example<a class="headerlink" href="#full-profiledpidsubsystem-example" title="Permalink to this heading">ï</a></h3>
<p>What does a PIDSubsystem look like when used in practice? The following examples are taken from the ArmBot example project (<a class="reference external" href="https://github.com/wpilibsuite/allwpilib/tree/main/wpilibjExamples/src/main/java/edu/wpi/first/wpilibj/examples/armbot">Java</a>, <a class="reference external" href="https://github.com/wpilibsuite/allwpilib/tree/main/wpilibcExamples/src/main/cpp/examples/ArmBot">C++</a>):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-3-QysrIChIZWFkZXIp" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-QysrIChIZWFkZXIp" name="QysrIChIZWFkZXIp" role="tab" tabindex="-1">C++ (Header)</button><button aria-controls="panel-3-QysrIChTb3VyY2Up" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-QysrIChTb3VyY2Up" name="QysrIChTb3VyY2Up" role="tab" tabindex="-1">C++ (Source)</button></div><div aria-labelledby="tab-3-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-3-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="kn">package</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.examples.armbot.subsystems</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.math.controller.ArmFeedforward</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 8</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.math.controller.ProfiledPIDController</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 9</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.math.trajectory.TrapezoidProfile</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.Encoder</span><span class="p">;</span><span class="w"></span>
<span class="linenos">11</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.examples.armbot.Constants.ArmConstants</span><span class="p">;</span><span class="w"></span>
<span class="linenos">12</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.motorcontrol.PWMSparkMax</span><span class="p">;</span><span class="w"></span>
<span class="linenos">13</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj2.command.ProfiledPIDSubsystem</span><span class="p">;</span><span class="w"></span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="cm">/** A robot arm subsystem that moves with a motion profile. */</span><span class="w"></span>
<span class="linenos">16</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ArmSubsystem</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ProfiledPIDSubsystem</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">17</span><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PWMSparkMax</span><span class="w"> </span><span class="n">m_motor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PWMSparkMax</span><span class="p">(</span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kMotorPort</span><span class="p">);</span><span class="w"></span>
<span class="linenos">18</span><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Encoder</span><span class="w"> </span><span class="n">m_encoder</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">19</span><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">Encoder</span><span class="p">(</span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kEncoderPorts</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kEncoderPorts</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span><span class="w"></span>
<span class="linenos">20</span><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ArmFeedforward</span><span class="w"> </span><span class="n">m_feedforward</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">21</span><span class="w">      </span><span class="k">new</span><span class="w"> </span><span class="n">ArmFeedforward</span><span class="p">(</span><span class="w"></span>
<span class="linenos">22</span><span class="w">          </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kSVolts</span><span class="p">,</span><span class="w"> </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kGVolts</span><span class="p">,</span><span class="w"></span>
<span class="linenos">23</span><span class="w">          </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kVVoltSecondPerRad</span><span class="p">,</span><span class="w"> </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kAVoltSecondSquaredPerRad</span><span class="p">);</span><span class="w"></span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="w">  </span><span class="cm">/** Create a new ArmSubsystem. */</span><span class="w"></span>
<span class="linenos">26</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="nf">ArmSubsystem</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">27</span><span class="w">    </span><span class="kd">super</span><span class="p">(</span><span class="w"></span>
<span class="linenos">28</span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ProfiledPIDController</span><span class="p">(</span><span class="w"></span>
<span class="linenos">29</span><span class="w">            </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kP</span><span class="p">,</span><span class="w"></span>
<span class="linenos">30</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="linenos">31</span><span class="w">            </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="linenos">32</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">TrapezoidProfile</span><span class="p">.</span><span class="na">Constraints</span><span class="p">(</span><span class="w"></span>
<span class="linenos">33</span><span class="w">                </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kMaxVelocityRadPerSecond</span><span class="p">,</span><span class="w"></span>
<span class="linenos">34</span><span class="w">                </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kMaxAccelerationRadPerSecSquared</span><span class="p">)),</span><span class="w"></span>
<span class="linenos">35</span><span class="w">        </span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="linenos">36</span><span class="w">    </span><span class="n">m_encoder</span><span class="p">.</span><span class="na">setDistancePerPulse</span><span class="p">(</span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kEncoderDistancePerPulse</span><span class="p">);</span><span class="w"></span>
<span class="linenos">37</span><span class="w">    </span><span class="c1">// Start arm at rest in neutral position</span><span class="w"></span>
<span class="linenos">38</span><span class="w">    </span><span class="n">setGoal</span><span class="p">(</span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kArmOffsetRads</span><span class="p">);</span><span class="w"></span>
<span class="linenos">39</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">40</span>
<span class="linenos">41</span><span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="linenos">42</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">useOutput</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">TrapezoidProfile</span><span class="p">.</span><span class="na">State</span><span class="w"> </span><span class="n">setpoint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">43</span><span class="w">    </span><span class="c1">// Calculate the feedforward from the sepoint</span><span class="w"></span>
<span class="linenos">44</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">feedforward</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_feedforward</span><span class="p">.</span><span class="na">calculate</span><span class="p">(</span><span class="n">setpoint</span><span class="p">.</span><span class="na">position</span><span class="p">,</span><span class="w"> </span><span class="n">setpoint</span><span class="p">.</span><span class="na">velocity</span><span class="p">);</span><span class="w"></span>
<span class="linenos">45</span><span class="w">    </span><span class="c1">// Add the feedforward to the PID output to get the motor output</span><span class="w"></span>
<span class="linenos">46</span><span class="w">    </span><span class="n">m_motor</span><span class="p">.</span><span class="na">setVoltage</span><span class="p">(</span><span class="n">output</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">feedforward</span><span class="p">);</span><span class="w"></span>
<span class="linenos">47</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="linenos">50</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">getMeasurement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">51</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">m_encoder</span><span class="p">.</span><span class="na">getDistance</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ArmConstants</span><span class="p">.</span><span class="na">kArmOffsetRads</span><span class="p">;</span><span class="w"></span>
<span class="linenos">52</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">53</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-QysrIChIZWFkZXIp" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-QysrIChIZWFkZXIp" name="QysrIChIZWFkZXIp" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="cp">#pragma once</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc/Encoder.h&gt;</span><span class="cp"></span>
<span class="linenos"> 8</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc/controller/ArmFeedforward.h&gt;</span><span class="cp"></span>
<span class="linenos"> 9</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc/motorcontrol/PWMSparkMax.h&gt;</span><span class="cp"></span>
<span class="linenos">10</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc2/command/ProfiledPIDSubsystem.h&gt;</span><span class="cp"></span>
<span class="linenos">11</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;units/angle.h&gt;</span><span class="cp"></span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="cm">/**</span>
<span class="linenos">14</span><span class="cm"> * A robot arm subsystem that moves with a motion profile.</span>
<span class="linenos">15</span><span class="cm"> */</span><span class="w"></span>
<span class="linenos">16</span><span class="k">class</span><span class="w"> </span><span class="nc">ArmSubsystem</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">frc2</span><span class="o">::</span><span class="n">ProfiledPIDSubsystem</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">17</span><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frc</span><span class="o">::</span><span class="n">TrapezoidProfile</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;::</span><span class="n">State</span><span class="p">;</span><span class="w"></span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos">20</span><span class="w">  </span><span class="n">ArmSubsystem</span><span class="p">();</span><span class="w"></span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">UseOutput</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="n">setpoint</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="w">  </span><span class="n">units</span><span class="o">::</span><span class="n">radian_t</span><span class="w"> </span><span class="nf">GetMeasurement</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="w"> </span><span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="linenos">27</span><span class="w">  </span><span class="n">frc</span><span class="o">::</span><span class="n">PWMSparkMax</span><span class="w"> </span><span class="n">m_motor</span><span class="p">;</span><span class="w"></span>
<span class="linenos">28</span><span class="w">  </span><span class="n">frc</span><span class="o">::</span><span class="n">Encoder</span><span class="w"> </span><span class="n">m_encoder</span><span class="p">;</span><span class="w"></span>
<span class="linenos">29</span><span class="w">  </span><span class="n">frc</span><span class="o">::</span><span class="n">ArmFeedforward</span><span class="w"> </span><span class="n">m_feedforward</span><span class="p">;</span><span class="w"></span>
<span class="linenos">30</span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-QysrIChTb3VyY2Up" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-QysrIChTb3VyY2Up" name="QysrIChTb3VyY2Up" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;subsystems/ArmSubsystem.h&quot;</span><span class="cp"></span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;Constants.h&quot;</span><span class="cp"></span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">ArmConstants</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span><span class="k">using</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frc</span><span class="o">::</span><span class="n">TrapezoidProfile</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;::</span><span class="n">State</span><span class="p">;</span><span class="w"></span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">ArmSubsystem</span><span class="o">::</span><span class="n">ArmSubsystem</span><span class="p">()</span><span class="w"></span>
<span class="linenos">13</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">frc2</span><span class="o">::</span><span class="n">ProfiledPIDSubsystem</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="linenos">14</span><span class="w">          </span><span class="n">frc</span><span class="o">::</span><span class="n">ProfiledPIDController</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;</span><span class="p">(</span><span class="w"></span>
<span class="linenos">15</span><span class="w">              </span><span class="n">kP</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">kMaxVelocity</span><span class="p">,</span><span class="w"> </span><span class="n">kMaxAcceleration</span><span class="p">})),</span><span class="w"></span>
<span class="linenos">16</span><span class="w">      </span><span class="n">m_motor</span><span class="p">(</span><span class="n">kMotorPort</span><span class="p">),</span><span class="w"></span>
<span class="linenos">17</span><span class="w">      </span><span class="n">m_encoder</span><span class="p">(</span><span class="n">kEncoderPorts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">kEncoderPorts</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="w"></span>
<span class="linenos">18</span><span class="w">      </span><span class="n">m_feedforward</span><span class="p">(</span><span class="n">kS</span><span class="p">,</span><span class="w"> </span><span class="n">kG</span><span class="p">,</span><span class="w"> </span><span class="n">kV</span><span class="p">,</span><span class="w"> </span><span class="n">kA</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">19</span><span class="w">  </span><span class="n">m_encoder</span><span class="p">.</span><span class="n">SetDistancePerPulse</span><span class="p">(</span><span class="n">kEncoderDistancePerPulse</span><span class="p">.</span><span class="n">value</span><span class="p">());</span><span class="w"></span>
<span class="linenos">20</span><span class="w">  </span><span class="c1">// Start arm in neutral position</span>
<span class="linenos">21</span><span class="w">  </span><span class="n">SetGoal</span><span class="p">(</span><span class="n">State</span><span class="p">{</span><span class="n">kArmOffset</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="n">_rad_per_s</span><span class="p">});</span><span class="w"></span>
<span class="linenos">22</span><span class="p">}</span><span class="w"></span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="kt">void</span><span class="w"> </span><span class="n">ArmSubsystem</span><span class="o">::</span><span class="n">UseOutput</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="w"> </span><span class="n">setpoint</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">25</span><span class="w">  </span><span class="c1">// Calculate the feedforward from the sepoint</span>
<span class="linenos">26</span><span class="w">  </span><span class="n">units</span><span class="o">::</span><span class="n">volt_t</span><span class="w"> </span><span class="n">feedforward</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="linenos">27</span><span class="w">      </span><span class="n">m_feedforward</span><span class="p">.</span><span class="n">Calculate</span><span class="p">(</span><span class="n">setpoint</span><span class="p">.</span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">setpoint</span><span class="p">.</span><span class="n">velocity</span><span class="p">);</span><span class="w"></span>
<span class="linenos">28</span><span class="w">  </span><span class="c1">// Add the feedforward to the PID output to get the motor output</span>
<span class="linenos">29</span><span class="w">  </span><span class="n">m_motor</span><span class="p">.</span><span class="n">SetVoltage</span><span class="p">(</span><span class="n">units</span><span class="o">::</span><span class="n">volt_t</span><span class="p">{</span><span class="n">output</span><span class="p">}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">feedforward</span><span class="p">);</span><span class="w"></span>
<span class="linenos">30</span><span class="p">}</span><span class="w"></span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="n">units</span><span class="o">::</span><span class="n">radian_t</span><span class="w"> </span><span class="n">ArmSubsystem</span><span class="o">::</span><span class="n">GetMeasurement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">33</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">units</span><span class="o">::</span><span class="n">radian_t</span><span class="p">{</span><span class="n">m_encoder</span><span class="p">.</span><span class="n">GetDistance</span><span class="p">()}</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kArmOffset</span><span class="p">;</span><span class="w"></span>
<span class="linenos">34</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div></div>
<p>Using a <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code> with commands can be very simple:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-4-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-4-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-4-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">55</span><span class="w">    </span><span class="c1">// Move the arm to 2 radians above horizontal when the &#39;A&#39; button is pressed.</span><span class="w"></span>
<span class="linenos">56</span><span class="w">    </span><span class="n">m_driverController</span><span class="w"></span>
<span class="linenos">57</span><span class="w">        </span><span class="p">.</span><span class="na">a</span><span class="p">()</span><span class="w"></span>
<span class="linenos">58</span><span class="w">        </span><span class="p">.</span><span class="na">onTrue</span><span class="p">(</span><span class="w"></span>
<span class="linenos">59</span><span class="w">            </span><span class="n">Commands</span><span class="p">.</span><span class="na">runOnce</span><span class="p">(</span><span class="w"></span>
<span class="linenos">60</span><span class="w">                </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">61</span><span class="w">                  </span><span class="n">m_robotArm</span><span class="p">.</span><span class="na">setGoal</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="linenos">62</span><span class="w">                  </span><span class="n">m_robotArm</span><span class="p">.</span><span class="na">enable</span><span class="p">();</span><span class="w"></span>
<span class="linenos">63</span><span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="linenos">64</span><span class="w">                </span><span class="n">m_robotArm</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos">32</span><span class="w">  </span><span class="c1">// Move the arm to 2 radians above horizontal when the &#39;A&#39; button is pressed.</span>
<span class="linenos">33</span><span class="w">  </span><span class="n">m_driverController</span><span class="p">.</span><span class="n">A</span><span class="p">().</span><span class="n">OnTrue</span><span class="p">(</span><span class="n">frc2</span><span class="o">::</span><span class="n">cmd</span><span class="o">::</span><span class="n">RunOnce</span><span class="p">(</span><span class="w"></span>
<span class="linenos">34</span><span class="w">      </span><span class="p">[</span><span class="k">this</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">35</span><span class="w">        </span><span class="n">m_arm</span><span class="p">.</span><span class="n">SetGoal</span><span class="p">(</span><span class="mi">2</span><span class="n">_rad</span><span class="p">);</span><span class="w"></span>
<span class="linenos">36</span><span class="w">        </span><span class="n">m_arm</span><span class="p">.</span><span class="n">Enable</span><span class="p">();</span><span class="w"></span>
<span class="linenos">37</span><span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="linenos">38</span><span class="w">      </span><span class="p">{</span><span class="o">&amp;</span><span class="n">m_arm</span><span class="p">}));</span><span class="w"></span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="profiledpidcommand">
<h2>ProfiledPIDCommand<a class="headerlink" href="#profiledpidcommand" title="Permalink to this heading">ï</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In C++, the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> class is templated on the unit type used for distance measurements, which may be angular or linear.  The passed-in values <em>must</em> have units consistent with the distance units, or a compile-time error will be thrown.  For more information on C++ units, see <a class="reference internal" href="../basic-programming/cpp-units.html#the-c-units-library"><span class="std std-ref">The C++ Units Library</span></a>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> class (<a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/wpilibj2/command/ProfiledPIDCommand.html">Java</a>, <a class="reference external" href="https://github.wpilib.org/allwpilib/docs/release/cpp/classfrc2_1_1_profiled_p_i_d_command.html">C++</a>) allows users to easily create commands with a built-in ProfiledPIDController.</p>
<section id="creating-a-pidcommand">
<h3>Creating a PIDCommand<a class="headerlink" href="#creating-a-pidcommand" title="Permalink to this heading">ï</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> can be created two ways - by subclassing the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> class, or by defining the command <a class="reference internal" href="organizing-command-based.html#inline-commands"><span class="std std-ref">inline</span></a>.  Both methods ultimately extremely similar, and ultimately the choice of which to use comes down to where the user desires that the relevant code be located.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> and overriding any methods, make sure to call the <code class="docutils literal notranslate"><span class="pre">super</span></code> version of those methods! Otherwise, control functionality will not work properly.</p>
</div>
<p>In either case, a <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> is created by passing the necessary parameters to its constructor (if defining a subclass, this can be done with a <cite>super()</cite> call):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-5-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-5-Qysr" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-5-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-5-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-5-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos">29</span><span class="w">  </span><span class="cm">/**</span>
<span class="linenos">30</span><span class="cm">   * Creates a new PIDCommand, which controls the given output with a ProfiledPIDController. Goal</span>
<span class="linenos">31</span><span class="cm">   * velocity is specified.</span>
<span class="linenos">32</span><span class="cm">   *</span>
<span class="linenos">33</span><span class="cm">   * @param controller the controller that controls the output.</span>
<span class="linenos">34</span><span class="cm">   * @param measurementSource the measurement of the process variable</span>
<span class="linenos">35</span><span class="cm">   * @param goalSource the controller&#39;s goal</span>
<span class="linenos">36</span><span class="cm">   * @param useOutput the controller&#39;s output</span>
<span class="linenos">37</span><span class="cm">   * @param requirements the subsystems required by this command</span>
<span class="linenos">38</span><span class="cm">   */</span><span class="w"></span>
<span class="linenos">39</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="nf">ProfiledPIDCommand</span><span class="p">(</span><span class="w"></span>
<span class="linenos">40</span><span class="w">      </span><span class="n">ProfiledPIDController</span><span class="w"> </span><span class="n">controller</span><span class="p">,</span><span class="w"></span>
<span class="linenos">41</span><span class="w">      </span><span class="n">DoubleSupplier</span><span class="w"> </span><span class="n">measurementSource</span><span class="p">,</span><span class="w"></span>
<span class="linenos">42</span><span class="w">      </span><span class="n">Supplier</span><span class="o">&lt;</span><span class="n">State</span><span class="o">&gt;</span><span class="w"> </span><span class="n">goalSource</span><span class="p">,</span><span class="w"></span>
<span class="linenos">43</span><span class="w">      </span><span class="n">BiConsumer</span><span class="o">&lt;</span><span class="n">Double</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="o">&gt;</span><span class="w"> </span><span class="n">useOutput</span><span class="p">,</span><span class="w"></span>
<span class="linenos">44</span><span class="w">      </span><span class="n">Subsystem</span><span class="p">...</span><span class="w"> </span><span class="n">requirements</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-Qysr" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-5-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos">39</span><span class="w">  </span><span class="cm">/**</span>
<span class="linenos">40</span><span class="cm">   * Creates a new PIDCommand, which controls the given output with a</span>
<span class="linenos">41</span><span class="cm">   * ProfiledPIDController.</span>
<span class="linenos">42</span><span class="cm">   *</span>
<span class="linenos">43</span><span class="cm">   * @param controller        the controller that controls the output.</span>
<span class="linenos">44</span><span class="cm">   * @param measurementSource the measurement of the process variable</span>
<span class="linenos">45</span><span class="cm">   * @param goalSource   the controller&#39;s goal</span>
<span class="linenos">46</span><span class="cm">   * @param useOutput         the controller&#39;s output</span>
<span class="linenos">47</span><span class="cm">   * @param requirements      the subsystems required by this command</span>
<span class="linenos">48</span><span class="cm">   */</span><span class="w"></span>
<span class="linenos">49</span><span class="w">  </span><span class="n">ProfiledPIDCommand</span><span class="p">(</span><span class="n">frc</span><span class="o">::</span><span class="n">ProfiledPIDController</span><span class="o">&lt;</span><span class="n">Distance</span><span class="o">&gt;</span><span class="w"> </span><span class="n">controller</span><span class="p">,</span><span class="w"></span>
<span class="linenos">50</span><span class="w">                     </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">Distance_t</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="n">measurementSource</span><span class="p">,</span><span class="w"></span>
<span class="linenos">51</span><span class="w">                     </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">State</span><span class="p">()</span><span class="o">&gt;</span><span class="w"> </span><span class="n">goalSource</span><span class="p">,</span><span class="w"></span>
<span class="linenos">52</span><span class="w">                     </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">State</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">useOutput</span><span class="p">,</span><span class="w"></span>
<span class="linenos">53</span><span class="w">                     </span><span class="n">std</span><span class="o">::</span><span class="n">initializer_list</span><span class="o">&lt;</span><span class="n">Subsystem</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">requirements</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div></div>
<section id="controller">
<h4>controller<a class="headerlink" href="#controller" title="Permalink to this heading">ï</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">controller</span></code> parameter is the <code class="docutils literal notranslate"><span class="pre">ProfiledPIDController</span></code> object that will be used by the command.  By passing this in, users can specify the PID gains, the motion profile constraints, and the period for the controller (if the user is using a nonstandard main robot loop period).</p>
<p>When subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code>, additional modifications (e.g. enabling continuous input) can be made to the controller in the constructor body by calling <code class="docutils literal notranslate"><span class="pre">getController()</span></code>.</p>
</section>
<section id="measurementsource">
<h4>measurementSource<a class="headerlink" href="#measurementsource" title="Permalink to this heading">ï</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">measurementSource</span></code> parameter is a function (usually passed as a <a class="reference internal" href="index.html#lambda-expressions-java"><span class="std std-ref">lambda</span></a>) that returns the measurement of the process variable.  Passing in the <code class="docutils literal notranslate"><span class="pre">measurementSource</span></code> function in <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> is functionally analogous to overriding the <a class="reference internal" href="#getmeasurement">getMeasurement()</a> function in <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>.</p>
<p>When subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code>, advanced users may further modify the measurement supplier by modifying the classâs <code class="docutils literal notranslate"><span class="pre">m_measurement</span></code> field.</p>
</section>
<section id="goalsource">
<h4>goalSource<a class="headerlink" href="#goalsource" title="Permalink to this heading">ï</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">goalSource</span></code> parameter is a function (usually passed as a <a class="reference internal" href="index.html#lambda-expressions-java"><span class="std std-ref">lambda</span></a>) that returns the current goal state for the mechanism.  If only a constant goal is needed, an overload exists that takes a constant goal rather than a supplier.  Additionally, if goal velocities are desired to be zero, overloads exist that take a constant distance rather than a full profile state.</p>
<p>When subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code>, advanced users may further modify the setpoint supplier by modifying the classâs <code class="docutils literal notranslate"><span class="pre">m_goal</span></code> field.</p>
</section>
<section id="id1">
<h4>useOutput<a class="headerlink" href="#id1" title="Permalink to this heading">ï</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">useOutput</span></code> parameter is a function (usually passed as a <a class="reference internal" href="index.html#lambda-expressions-java"><span class="std std-ref">lambda</span></a>) that consumes the output and setpoint state of the control loop.  Passing in the <code class="docutils literal notranslate"><span class="pre">useOutput</span></code> function in <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> is functionally analogous to overriding the <a class="reference internal" href="#useoutput">useOutput()</a> function in <code class="docutils literal notranslate"><span class="pre">ProfiledPIDSubsystem</span></code>.</p>
<p>When subclassing <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code>, advanced users may further modify the output consumer by modifying the classâs <code class="docutils literal notranslate"><span class="pre">m_useOutput</span></code> field.</p>
</section>
<section id="requirements">
<h4>requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">ï</a></h4>
<p>Like all inlineable commands, <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> allows the user to specify its subsystem requirements as a constructor parameter.</p>
</section>
</section>
<section id="full-profiledpidcommand-example">
<h3>Full ProfiledPIDCommand Example<a class="headerlink" href="#full-profiledpidcommand-example" title="Permalink to this heading">ï</a></h3>
<p>What does a <code class="docutils literal notranslate"><span class="pre">ProfiledPIDCommand</span></code> look like when used in practice? The following examples are from the GyroDriveCommands example project (<a class="reference external" href="https://github.com/wpilibsuite/allwpilib/tree/main/wpilibjExamples/src/main/java/edu/wpi/first/wpilibj/examples/gyrodrivecommands">Java</a>, <a class="reference external" href="https://github.com/wpilibsuite/allwpilib/tree/main/wpilibcExamples/src/main/cpp/examples/GyroDriveCommands">C++</a>):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-SmF2YQ==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-6-SmF2YQ==" name="SmF2YQ==" role="tab" tabindex="0">Java</button><button aria-controls="panel-6-QysrIChIZWFkZXIp" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-QysrIChIZWFkZXIp" name="QysrIChIZWFkZXIp" role="tab" tabindex="-1">C++ (Header)</button><button aria-controls="panel-6-QysrIChTb3VyY2Up" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-6-QysrIChTb3VyY2Up" name="QysrIChTb3VyY2Up" role="tab" tabindex="-1">C++ (Source)</button></div><div aria-labelledby="tab-6-SmF2YQ==" class="sphinx-tabs-panel group-tab" id="panel-6-SmF2YQ==" name="SmF2YQ==" role="tabpanel" tabindex="0"><div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="kn">package</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.examples.gyrodrivecommands.commands</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.math.controller.ProfiledPIDController</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 8</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.math.trajectory.TrapezoidProfile</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 9</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.examples.gyrodrivecommands.Constants.DriveConstants</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj.examples.gyrodrivecommands.subsystems.DriveSubsystem</span><span class="p">;</span><span class="w"></span>
<span class="linenos">11</span><span class="kn">import</span><span class="w"> </span><span class="nn">edu.wpi.first.wpilibj2.command.ProfiledPIDCommand</span><span class="p">;</span><span class="w"></span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="cm">/** A command that will turn the robot to the specified angle using a motion profile. */</span><span class="w"></span>
<span class="linenos">14</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TurnToAngleProfiled</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ProfiledPIDCommand</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">15</span><span class="w">  </span><span class="cm">/**</span>
<span class="linenos">16</span><span class="cm">   * Turns to robot to the specified angle using a motion profile.</span>
<span class="linenos">17</span><span class="cm">   *</span>
<span class="linenos">18</span><span class="cm">   * @param targetAngleDegrees The angle to turn to</span>
<span class="linenos">19</span><span class="cm">   * @param drive The drive subsystem to use</span>
<span class="linenos">20</span><span class="cm">   */</span><span class="w"></span>
<span class="linenos">21</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="nf">TurnToAngleProfiled</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">targetAngleDegrees</span><span class="p">,</span><span class="w"> </span><span class="n">DriveSubsystem</span><span class="w"> </span><span class="n">drive</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">22</span><span class="w">    </span><span class="kd">super</span><span class="p">(</span><span class="w"></span>
<span class="linenos">23</span><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ProfiledPIDController</span><span class="p">(</span><span class="w"></span>
<span class="linenos">24</span><span class="w">            </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kTurnP</span><span class="p">,</span><span class="w"></span>
<span class="linenos">25</span><span class="w">            </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kTurnI</span><span class="p">,</span><span class="w"></span>
<span class="linenos">26</span><span class="w">            </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kTurnD</span><span class="p">,</span><span class="w"></span>
<span class="linenos">27</span><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">TrapezoidProfile</span><span class="p">.</span><span class="na">Constraints</span><span class="p">(</span><span class="w"></span>
<span class="linenos">28</span><span class="w">                </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kMaxTurnRateDegPerS</span><span class="p">,</span><span class="w"></span>
<span class="linenos">29</span><span class="w">                </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kMaxTurnAccelerationDegPerSSquared</span><span class="p">)),</span><span class="w"></span>
<span class="linenos">30</span><span class="w">        </span><span class="c1">// Close loop on heading</span><span class="w"></span>
<span class="linenos">31</span><span class="w">        </span><span class="n">drive</span><span class="p">::</span><span class="n">getHeading</span><span class="p">,</span><span class="w"></span>
<span class="linenos">32</span><span class="w">        </span><span class="c1">// Set reference to target</span><span class="w"></span>
<span class="linenos">33</span><span class="w">        </span><span class="n">targetAngleDegrees</span><span class="p">,</span><span class="w"></span>
<span class="linenos">34</span><span class="w">        </span><span class="c1">// Pipe output to turn robot</span><span class="w"></span>
<span class="linenos">35</span><span class="w">        </span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">setpoint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">drive</span><span class="p">.</span><span class="na">arcadeDrive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">),</span><span class="w"></span>
<span class="linenos">36</span><span class="w">        </span><span class="c1">// Require the drive</span><span class="w"></span>
<span class="linenos">37</span><span class="w">        </span><span class="n">drive</span><span class="p">);</span><span class="w"></span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="w">    </span><span class="c1">// Set the controller to be continuous (because it is an angle controller)</span><span class="w"></span>
<span class="linenos">40</span><span class="w">    </span><span class="n">getController</span><span class="p">().</span><span class="na">enableContinuousInput</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">);</span><span class="w"></span>
<span class="linenos">41</span><span class="w">    </span><span class="c1">// Set the controller tolerance - the delta tolerance ensures the robot is stationary at the</span><span class="w"></span>
<span class="linenos">42</span><span class="w">    </span><span class="c1">// setpoint before it is considered as having reached the reference</span><span class="w"></span>
<span class="linenos">43</span><span class="w">    </span><span class="n">getController</span><span class="p">()</span><span class="w"></span>
<span class="linenos">44</span><span class="w">        </span><span class="p">.</span><span class="na">setTolerance</span><span class="p">(</span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kTurnToleranceDeg</span><span class="p">,</span><span class="w"> </span><span class="n">DriveConstants</span><span class="p">.</span><span class="na">kTurnRateToleranceDegPerS</span><span class="p">);</span><span class="w"></span>
<span class="linenos">45</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">46</span>
<span class="linenos">47</span><span class="w">  </span><span class="nd">@Override</span><span class="w"></span>
<span class="linenos">48</span><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isFinished</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">49</span><span class="w">    </span><span class="c1">// End when the controller is at the reference.</span><span class="w"></span>
<span class="linenos">50</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getController</span><span class="p">().</span><span class="na">atGoal</span><span class="p">();</span><span class="w"></span>
<span class="linenos">51</span><span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="linenos">52</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-QysrIChIZWFkZXIp" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-QysrIChIZWFkZXIp" name="QysrIChIZWFkZXIp" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="cp">#pragma once</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc2/command/CommandHelper.h&gt;</span><span class="cp"></span>
<span class="linenos"> 8</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc2/command/ProfiledPIDCommand.h&gt;</span><span class="cp"></span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;subsystems/DriveSubsystem.h&quot;</span><span class="cp"></span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="cm">/**</span>
<span class="linenos">13</span><span class="cm"> * A command that will turn the robot to the specified angle using a motion</span>
<span class="linenos">14</span><span class="cm"> * profile.</span>
<span class="linenos">15</span><span class="cm"> */</span><span class="w"></span>
<span class="linenos">16</span><span class="k">class</span><span class="w"> </span><span class="nc">TurnToAngleProfiled</span><span class="w"></span>
<span class="linenos">17</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">frc2</span><span class="o">::</span><span class="n">CommandHelper</span><span class="o">&lt;</span><span class="n">frc2</span><span class="o">::</span><span class="n">ProfiledPIDCommand</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="linenos">18</span><span class="w">                                 </span><span class="n">TurnToAngleProfiled</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">19</span><span class="w"> </span><span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="linenos">20</span><span class="w">  </span><span class="cm">/**</span>
<span class="linenos">21</span><span class="cm">   * Turns to robot to the specified angle using a motion profile.</span>
<span class="linenos">22</span><span class="cm">   *</span>
<span class="linenos">23</span><span class="cm">   * @param targetAngleDegrees The angle to turn to</span>
<span class="linenos">24</span><span class="cm">   * @param drive              The drive subsystem to use</span>
<span class="linenos">25</span><span class="cm">   */</span><span class="w"></span>
<span class="linenos">26</span><span class="w">  </span><span class="n">TurnToAngleProfiled</span><span class="p">(</span><span class="n">units</span><span class="o">::</span><span class="n">degree_t</span><span class="w"> </span><span class="n">targetAngleDegrees</span><span class="p">,</span><span class="w"></span>
<span class="linenos">27</span><span class="w">                      </span><span class="n">DriveSubsystem</span><span class="o">*</span><span class="w"> </span><span class="n">drive</span><span class="p">);</span><span class="w"></span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nf">IsFinished</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span><span class="w"></span>
<span class="linenos">30</span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-QysrIChTb3VyY2Up" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-6-QysrIChTb3VyY2Up" name="QysrIChTb3VyY2Up" role="tabpanel" tabindex="0"><div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;commands/TurnToAngleProfiled.h&quot;</span><span class="cp"></span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;frc/controller/ProfiledPIDController.h&gt;</span><span class="cp"></span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">DriveConstants</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">TurnToAngleProfiled</span><span class="o">::</span><span class="n">TurnToAngleProfiled</span><span class="p">(</span><span class="n">units</span><span class="o">::</span><span class="n">degree_t</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"></span>
<span class="linenos">12</span><span class="w">                                         </span><span class="n">DriveSubsystem</span><span class="o">*</span><span class="w"> </span><span class="n">drive</span><span class="p">)</span><span class="w"></span>
<span class="linenos">13</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">CommandHelper</span><span class="p">{</span><span class="w"></span>
<span class="linenos">14</span><span class="w">          </span><span class="n">frc</span><span class="o">::</span><span class="n">ProfiledPIDController</span><span class="o">&lt;</span><span class="n">units</span><span class="o">::</span><span class="n">radians</span><span class="o">&gt;</span><span class="p">{</span><span class="w"></span>
<span class="linenos">15</span><span class="w">              </span><span class="n">kTurnP</span><span class="p">,</span><span class="w"> </span><span class="n">kTurnI</span><span class="p">,</span><span class="w"> </span><span class="n">kTurnD</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">kMaxTurnRate</span><span class="p">,</span><span class="w"> </span><span class="n">kMaxTurnAcceleration</span><span class="p">}},</span><span class="w"></span>
<span class="linenos">16</span><span class="w">          </span><span class="c1">// Close loop on heading</span>
<span class="linenos">17</span><span class="w">          </span><span class="p">[</span><span class="n">drive</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">drive</span><span class="o">-&gt;</span><span class="n">GetHeading</span><span class="p">();</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="linenos">18</span><span class="w">          </span><span class="c1">// Set reference to target</span>
<span class="linenos">19</span><span class="w">          </span><span class="n">target</span><span class="p">,</span><span class="w"></span>
<span class="linenos">20</span><span class="w">          </span><span class="c1">// Pipe output to turn robot</span>
<span class="linenos">21</span><span class="w">          </span><span class="p">[</span><span class="n">drive</span><span class="p">](</span><span class="kt">double</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">setpointState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">22</span><span class="w">            </span><span class="n">drive</span><span class="o">-&gt;</span><span class="n">ArcadeDrive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span><span class="w"></span>
<span class="linenos">23</span><span class="w">          </span><span class="p">},</span><span class="w"></span>
<span class="linenos">24</span><span class="w">          </span><span class="c1">// Require the drive</span>
<span class="linenos">25</span><span class="w">          </span><span class="p">{</span><span class="n">drive</span><span class="p">}}</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">26</span><span class="w">  </span><span class="c1">// Set the controller to be continuous (because it is an angle controller)</span>
<span class="linenos">27</span><span class="w">  </span><span class="n">GetController</span><span class="p">().</span><span class="n">EnableContinuousInput</span><span class="p">(</span><span class="mi">-180</span><span class="n">_deg</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="n">_deg</span><span class="p">);</span><span class="w"></span>
<span class="linenos">28</span><span class="w">  </span><span class="c1">// Set the controller tolerance - the delta tolerance ensures the robot is</span>
<span class="linenos">29</span><span class="w">  </span><span class="c1">// stationary at the setpoint before it is considered as having reached the</span>
<span class="linenos">30</span><span class="w">  </span><span class="c1">// reference</span>
<span class="linenos">31</span><span class="w">  </span><span class="n">GetController</span><span class="p">().</span><span class="n">SetTolerance</span><span class="p">(</span><span class="n">kTurnTolerance</span><span class="p">,</span><span class="w"> </span><span class="n">kTurnRateTolerance</span><span class="p">);</span><span class="w"></span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="w">  </span><span class="n">AddRequirements</span><span class="p">({</span><span class="n">drive</span><span class="p">});</span><span class="w"></span>
<span class="linenos">34</span><span class="p">}</span><span class="w"></span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="kt">bool</span><span class="w"> </span><span class="n">TurnToAngleProfiled</span><span class="o">::</span><span class="n">IsFinished</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos">37</span><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">GetController</span><span class="p">().</span><span class="n">AtGoal</span><span class="p">();</span><span class="w"></span>
<span class="linenos">38</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div></div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="profile-subsystems-commands.html" class="btn btn-neutral float-left" title="Motion Profiling through TrapezoidProfileSubsystems and TrapezoidProfileCommands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="command-based-changes.html" class="btn btn-neutral float-right" title="2020 Command-Based Rewrite: What Changed?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, FIRST and other WPILib Contributors. This work is licensed under a Creative Commons Attribution 4.0 International License.
      <span class="commit">Revision <code>c3ff9f30</code>.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/2022/">2022</a></dd>
        
          <dd><a href="/en/2021/">2021</a></dd>
        
          <dd><a href="/en/2020/">2020</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//docs.wpilib.org/_/downloads/en/latest/pdf/">pdf</a></dd>
        
          <dd><a href="//docs.wpilib.org/_/downloads/en/latest/htmlzip/">html</a></dd>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/frc-docs/?fromdocs=frc-docs">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/frc-docs/?fromdocs=frc-docs">Builds</a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
  <script>
    if (typeof READTHEDOCS_DATA !== 'undefined') {
        if (!READTHEDOCS_DATA.features) {
          READTHEDOCS_DATA.features = {};
        }
        READTHEDOCS_DATA.features.docsearch_disabled = false;
      }
    </script>

</body>
</html>